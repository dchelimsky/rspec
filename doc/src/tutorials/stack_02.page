h2. A Simple Stack

h3. An Empty Stack

So now we know that when you first create a stack it is empty. What's next? We could make some more specifications about a new stack, but the fact that it is an empty stack is more interesting from a behavioural perspective than a new stack. So let's start talking about the behaviour of an <em>empty</em> stack.

We all know the standard messages we want on a stack: some variation of push, pop and top. What should happen when we send 'push' to an empty stack? The usual first move is to specify that it has a size of 1, but we don't have a <code>size</code> method, nor do we want one if we can avoid it. We can, however, specify that it is no longer empty after a push.

<ruby>
context "An empty stack" do
  specify "should not be empty after 'push'" do
  end
end
</ruby>
<br>
<pre>
$ spec stack_spec.rb -f s

A new stack
- should be empty

An empty stack
- should not be empty after 'push'

Finished in 0.000391 seconds

2 contexts, 2 specifications, 0 failures
</pre>

See how that's reading as a spec? Let's fill in the specification. First we add the setup for our context.

<ruby>
context "An empty stack" do
  setup do
    @stack = Stack.new
  end
  specify "should not be empty after 'push'" do
  end
end
</ruby>
<br>
<pre>
$ spec stack_spec.rb -f s

A new stack
- should be empty

An empty stack
- should not be empty after 'push'

Finished in 0.000444 seconds

2 contexts, 2 specifications, 0 failures
</pre>

No change in the result. Now we'll push something on to the stack.

<ruby>
context "An empty stack" do
  setup do
    @stack = Stack.new
  end
  specify "should not be empty after 'push'" do
    @stack.push 37
  end
end
</ruby>
<br>
<pre>
$ spec stack_spec.rb -f s

A new stack
- should be empty

An empty stack
- should not be empty after 'push' (FAILED - 1)

1)
NoMethodError in 'An empty stack should not be empty after 'push''
undefined method `push' for #<Stack:0x36d0e0>
./stack_spec.rb:17:in `should not be empty after 'push''

Finished in 0.000548 seconds

2 contexts, 2 specifications, 1 failure
</pre>

The <code>NoMethodError</code> tells us we need to add a push method to the stack.

<ruby>
class Stack
  def empty?
    true
  end
  def push item
  end
end
</ruby>
<br>
<pre>
$ spec stack_spec.rb -f s

A new stack
- should be empty

An empty stack
- should not be empty after 'push'

Finished in 0.000427 seconds

2 contexts, 2 specifications, 0 failures
</pre>

Remember, add a little bit at a time, run the specs and resolve name errors (these are like compilation failures in java and C#). Next we set our expectation:

<ruby>
context "An empty stack" do
  setup do
    @stack = Stack.new
  end
  specify "should not be empty after 'push'" do
    @stack.push 37
    @stack.should_not_be_empty
  end
end
</ruby>
<br>
<pre>
$ spec stack_spec.rb -f s

A new stack
- should be empty

An empty stack
- should not be empty after 'push' (FAILED - 1)

1)
ExpectationNotMetError in 'An empty stack should not be empty after 'push''
Stack #<Stack:0x36cf50> should not be empty
./stack_spec.rb:18:in `should not be empty after 'push''

Finished in 0.000604 seconds

2 contexts, 2 specifications, 1 failure
</pre>

The <code>ExpectationNotMetError</code> tells us we have something to implement. We want to do the simplest thing that we can do to meet our existing expectations. At this point we don't know anything about collections or even specific values, so we can just manage whether or not it is empty.

<ruby>
class Stack
  def initialize
    @empty = true
  end
  def empty?
    @empty
  end
  def push item
    @empty = false
  end
end
</ruby>
<br>
<pre>
$ spec stack_spec.rb -f s

A new stack
- should be empty

An empty stack
- should not be empty after 'push'

Finished in 0.000443 seconds

2 contexts, 2 specifications, 0 failures
</pre>

Again, this may seem a little odd, but we haven't specified anything yet about what happens to things that get pushed on to the stack. That's right around the corner though...

<a href="stack_01.html">Previous</a> |
<a href="stack_03.html">Next</a>